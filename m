Return-Path: <linux-sh-owner@vger.kernel.org>
X-Original-To: lists+linux-sh@lfdr.de
Delivered-To: lists+linux-sh@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 35CC1122628
	for <lists+linux-sh@lfdr.de>; Tue, 17 Dec 2019 09:03:19 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726690AbfLQIDP (ORCPT <rfc822;lists+linux-sh@lfdr.de>);
        Tue, 17 Dec 2019 03:03:15 -0500
Received: from relmlor2.renesas.com ([210.160.252.172]:45870 "EHLO
        relmlie6.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL)
        by vger.kernel.org with ESMTP id S1726281AbfLQIDP (ORCPT
        <rfc822;linux-sh@vger.kernel.org>); Tue, 17 Dec 2019 03:03:15 -0500
Date:   17 Dec 2019 17:03:14 +0900
X-IronPort-AV: E=Sophos;i="5.69,324,1571670000"; 
   d="scan'208";a="34417104"
Received: from unknown (HELO relmlir6.idc.renesas.com) ([10.200.68.152])
  by relmlie6.idc.renesas.com with ESMTP; 17 Dec 2019 17:03:14 +0900
Received: from morimoto-PC.renesas.com (unknown [10.166.18.140])
        by relmlir6.idc.renesas.com (Postfix) with ESMTP id 0950541C9EBD;
        Tue, 17 Dec 2019 17:03:14 +0900 (JST)
Message-ID: <874kxzgz0d.wl-kuninori.morimoto.gx@renesas.com>
From:   Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
To:     Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
Cc:     Karl Nasrallah <knnspeed@aol.com>, linux-sh@vger.kernel.org
Subject: Re: can someone solve string_32.h issue for SH ?
In-Reply-To: <87a77rgzsi.wl-kuninori.morimoto.gx@renesas.com>
References: <2131872019.198149.1576568166106.ref@mail.yahoo.com>
        <2131872019.198149.1576568166106@mail.yahoo.com>
        <87a77rgzsi.wl-kuninori.morimoto.gx@renesas.com>
User-Agent: Wanderlust/2.15.9 Emacs/24.5 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-sh-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-sh.vger.kernel.org>
X-Mailing-List: linux-sh@vger.kernel.org


Hi Karl, again

> > This appears to be your culprit:
> > 
> > char vub_name[3 + (9 * 8) + 4 + 1];
> > 
> > in struct vub300_mmc_host on line 302 of the file /drivers/mmc/host/vub300.c.
> > 
> > This is the exact line triggering your warning, also in vub300.c:
> > 
> > 515 strncpy(vub300->vub_name, "EMPTY Processing Disabled", sizeof(vub300->vub_name));
> > 
> > And the fix would be to probably fix vub300.c, do a sizeof() on the string or hardcode the string size to 26 characters since the string is already hardcoded in as it stands.
> > 
> > The asm doesn't look wrong.
> > 
> > Hope this helps!
> > (Sorry I can't do any pretty formatting: mail client and majordomo don't play very well together and html gets generated at even the slightest provocation, despite having disabled it...)

Oops ??

strncpy() should behave like this,
and people expect it ?

	char s[4];

	strncpy(s, "abc", 4);
	// s = {'a', 'b', 'c', '\0'}

	strncpy(s, "abcd", 4);
	// s = {'a', 'b', 'c', 'd'}

	strncpy(s, "ab", 4);
	// s = {'a', 'b', '\0', '\0'}


Thank you for your help !!
Best regards
---
Kuninori Morimoto
