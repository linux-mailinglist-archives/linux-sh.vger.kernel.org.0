Return-Path: <linux-sh-owner@vger.kernel.org>
X-Original-To: lists+linux-sh@lfdr.de
Delivered-To: lists+linux-sh@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id B328D7B53D5
	for <lists+linux-sh@lfdr.de>; Mon,  2 Oct 2023 15:25:16 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S236717AbjJBNWA convert rfc822-to-8bit (ORCPT
        <rfc822;lists+linux-sh@lfdr.de>); Mon, 2 Oct 2023 09:22:00 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:38902 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S237313AbjJBNV7 (ORCPT
        <rfc822;linux-sh@vger.kernel.org>); Mon, 2 Oct 2023 09:21:59 -0400
Received: from hsmtpd-def.xspmail.jp (hsmtpd-def.xspmail.jp [202.238.198.243])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 8C18DB3
        for <linux-sh@vger.kernel.org>; Mon,  2 Oct 2023 06:21:56 -0700 (PDT)
X-Country-Code: JP
Received: from sakura.ysato.name (ik1-413-38519.vs.sakura.ne.jp [153.127.30.23])
        by hsmtpd-out-1.asahinet.cluster.xspmail.jp (Halon) with ESMTPA
        id 91b66f99-5cc7-4aa4-9bc3-c50478876f4e;
        Mon, 02 Oct 2023 22:21:54 +0900 (JST)
Received: from SIOS1075.ysato.ml (ZM005235.ppp.dion.ne.jp [222.8.5.235])
        by sakura.ysato.name (Postfix) with ESMTPSA id E809B1C026E;
        Mon,  2 Oct 2023 22:21:52 +0900 (JST)
Date:   Mon, 02 Oct 2023 22:21:52 +0900
Message-ID: <87bkdhtb0v.wl-ysato@users.sourceforge.jp>
From:   Yoshinori Sato <ysato@users.sourceforge.jp>
To:     Geert Uytterhoeven <geert@linux-m68k.org>
Cc:     linux-sh@vger.kernel.org, glaubitz@physik.fu-berlin.de
Subject: Re: [RFC PATCH v2 26/30] arch/sh: RTS7751R2D Plus DeviceTree.
In-Reply-To: <CAMuHMdUUEhev1F40FhiJyCENvca9YTx_hv1gT_DTXyVMCKjU8g@mail.gmail.com>
References: <cover.1694596125.git.ysato@users.sourceforge.jp>
        <d63793503fbbc7d5ca7b40d6b31678d371b69c29.1694596125.git.ysato@users.sourceforge.jp>
        <CAMuHMdUUEhev1F40FhiJyCENvca9YTx_hv1gT_DTXyVMCKjU8g@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?ISO-8859-4?Q?Goj=F2?=) APEL-LB/10.8 EasyPG/1.0.0
 Emacs/28.2 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8BIT
X-Spam-Status: No, score=-1.2 required=5.0 tests=BAYES_00,
        RCVD_IN_DNSWL_BLOCKED,SPF_HELO_PASS,SPF_SOFTFAIL autolearn=no
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-sh.vger.kernel.org>
X-Mailing-List: linux-sh@vger.kernel.org

On Tue, 19 Sep 2023 22:25:19 +0900,
Geert Uytterhoeven wrote:
> 
> Hi Sato-san,
> 
> On Wed, Sep 13, 2023 at 11:24â€¯AM Yoshinori Sato
> <ysato@users.sourceforge.jp> wrote:
> > Signed-off-by: Yoshinori Sato <ysato@users.sourceforge.jp>
> 
> Thanks for your patch!
> 
> > --- /dev/null
> > +++ b/arch/sh/boot/dts/rts7751r2dplus.dts
> > @@ -0,0 +1,124 @@
> > +// SPDX-License-Identifier: GPL-2.0
> > +/*
> > + * Device Tree Source for the Renesas RTS7751R2D Plus
> > + */
> > +
> > +/dts-v1/;
> > +
> > +#include "sh7751.dtsi"
> 
> #include "sh7751r.dtsi"?
> 
> To make that work, you can create "sh7751.dtsi" that includes
> "sh7751.dtsi" and overrides the parts that are different.

The only difference between 7751 and 7751R is CPG,
so I don't differentiate between them.

Shall we write the CPG differences in sh7751r.dtsi?

> > +
> > +/ {
> > +       model = "Renesas RTS7715R2D Plus";
> > +       compatible = "renesas,r2dplus";
> 
> compatible = "renesas,r2dplus", "renesas,sh7751r", "renesas,sh7751".
> 
> And all these compatible values must be documented in the DT
> binding documentation.
> 
> > +       #address-cells = <1>;
> > +       #size-cells = <1>;
> > +       interrupt-parent = <&shintc>;
> > +
> > +       aliases {
> > +               serial0 = &scif1;
> > +       };
> > +
> > +       chosen {
> > +       };
> > +
> > +       clocks {
> > +               xtal: oscillator {
> > +                       #clock-cells = <0>;
> > +                       compatible = "fixed-clock";
> > +                       clock-frequency = <22222222>;
> > +               };
> 
> Please
> > +
> > +               cpg: cpg@ffc00000 {
> 
> "&cpg"?
> 
> > +                       compatible = "renesas,sh7750r-cpg",
> > +                                    "renesas,sh7750-cpg";
> 
> There should be no need to override the cpg's compatible value.
> 
> > +                       renesas,mode = <5>;
> > +               };
> > +       };
> > +
> > +       cpus {
> > +               cpu@0 {
> > +                     clock-frequency = <266666666>;
> 
> As the CPU clock is programmable, the "clock-frequency"
> property should probably be replaced by a "clocks" property in the
> base sh7751.dtsi.
> 
> > +               };
> > +       };
> > +
> > +       memory@c000000 {
> > +               device_type = "memory";
> > +               reg = <0x0c000000 0x4000000>;
> > +       };
> > +
> > +       r2dintc: sh7751irl_encoder@a4000000 {
> > +               compatible = "renesas,sh7751-irl-ext";
> > +               reg = <0xa4000000 0x02>;
> > +               interrupt-controller;
> > +               #address-cells = <1>;
> > +               #interrupt-cells = <2>;
> > +               sh7751irl,width = <16>;
> > +               sh7751irl,polarity = <0>;
> > +               sh7751irl,irqbit =<11>,         /* PCI INTD */
> > +                                 <9>,          /* CF IDE */
> > +                                 <8>,          /* CF CD */
> > +                                 <12>,         /* PCI INTC */
> > +                                 <10>,         /* SM501 */
> > +                                 <6>,          /* KEY */
> > +                                 <5>,          /* RTC ALARM */
> > +                                 <4>,          /* RTC T */
> > +                                 <7>,          /* SDCARD */
> > +                                 <14>,         /* PCI INTA */
> > +                                 <13>,         /* PCI INTB */
> > +                                 <0>,          /* EXT */
> > +                                 <15>;         /* TP */
> > +       };
> > +
> > +       display@1,0 {
> > +               compatible = "smi,sm501";
> > +               reg = <0x10000000 0x03e00000
> > +                      0x13e00000 0x00200000>;
> > +               interrupt-parent = <&r2dintc>;
> > +               interrupts = <4 0>;
> > +               mode = "640x480-16@60";
> > +               little-endian;
> > +               sm501,devices = "usb-host","uart0";
> > +       };
> > +
> > +       compact-flash@b4001000 {
> > +               compatible = "ata-generic";
> 
> compact-flash@b4001000: compatible:0: 'ata-generic' is not one of
> ['arm,vexpress-cf', 'fsl,mpc8349emitx-pata']
> from schema $id: http://devicetree.org/schemas/ata/ata-generic.yaml#
> 
> > +               reg = <0xb4001000 0x0e>, <0xb400080c 2>;
> > +               reg-shift = <1>;
> > +               interrupt-parent = <&r2dintc>;
> > +               interrupts = <1 0>;
> > +       };
> > +
> > +       flash@0 {
> > +               compatible = "cfi-flash";
> > +               reg = <0x00000000 0x02000000>;
> > +               device-width = <2>;
> > +               #address-cells = <1>;
> > +               #size-cells = <1>;
> > +               partition@0 {
> > +                       label = "U-Boot";
> > +                       reg = <0x00000000 0x00040000>;
> > +               };
> > +               partition@1 {
> > +                       label = "Environemt";
> 
> Environment
> 
> > +                       reg = <0x00040000 0x00040000>;
> > +               };
> 
> Several of the above comments apply to "[RFC PATCH v2 27/30]
> arch/sh: LANDISK DeviceTree." and "[RFC PATCH v2 28/30] arch/sh:
> USL-5P DeviceTree.", too.
> 
> Gr{oetje,eeting}s,
> 
>                         Geert
> 
> --
> Geert Uytterhoeven -- There's lots of Linux beyond ia32 -- geert@linux-m68k.org
> 
> In personal conversations with technical people, I call myself a hacker. But
> when I'm talking to journalists I just say "programmer" or something like that.
>                                 -- Linus Torvalds

-- 
Yosinori Sato
